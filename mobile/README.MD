Perfeito üî• ‚Äî aqui est√° o arquivo **j√° convertido para Markdown (`README.md`)**, formatado, bonito e pronto pra colar direto no VS Code (com preview autom√°tico).

---

# üì± Quartinho-PS Mobile

Aplicativo **Flutter** do **Quartinho-PS**, que consome a API Django e usa **WebSockets via Daphne** para chat em tempo real.

Agora o backend pode ser configurado dinamicamente com:

```bash
--dart-define=BACKEND_HOST=http://SEU_IP:8000
```

sem precisar editar o c√≥digo.

---

## üß© Pr√©-requisitos

* **Flutter SDK** instalado ([guia oficial](https://docs.flutter.dev/get-started/install))
* **Backend Django** rodando com **Daphne**
* Celular e computador conectados na **mesma rede Wi-Fi**

---

## ‚öôÔ∏è Passos para rodar o app

### 1Ô∏è‚É£ Descubra o IP da sua m√°quina

No PowerShell (Windows):

```bash
ipconfig
```

Procure o campo (exemplo):

```
Endere√ßo IPv4 . . . . . . . . . . . : 192.168.xx.xxx
```

---

### 2Ô∏è‚É£ Configure o host do backend (sem editar c√≥digo)

Use `--dart-define=BACKEND_HOST` para informar o IP/porta.

| Ambiente                         | Comando                                                                        |
| -------------------------------- | ------------------------------------------------------------------------------ |
| **Android Emulador**             | `flutter run -d emulator-5554 --dart-define=BACKEND_HOST=http://10.0.2.2:8000` |
| **Celular F√≠sico (mesmo Wi-Fi)** | `flutter run --dart-define=BACKEND_HOST=http://192.168.15.101:8000`            |
| **Web (Chrome)**                 | `flutter run -d chrome --dart-define=BACKEND_HOST=http://127.0.0.1:8000`       |

---

### 3Ô∏è‚É£ Conecte o dispositivo

* **Android:** ative a **Depura√ß√£o USB** e permita a conex√£o.
* **iOS:** use um **Mac com Xcode**.

---

### 4Ô∏è‚É£ Verifique permiss√£o de internet (Android)

No arquivo `android/app/src/main/AndroidManifest.xml`, confirme a linha:

```xml
<uses-permission android:name="android.permission.INTERNET"/>
```

---

### 5Ô∏è‚É£ Rode o backend com **Daphne (ASGI)**

Agora o chat usa **WebSockets**, ent√£o o servidor deve rodar com **Daphne**, n√£o com `runserver`.

```bash
cd backend
.venv\Scripts\Activate.ps1
daphne -b 0.0.0.0 -p 8000 backend.asgi:application
```

> ‚ö†Ô∏è Se usar `python manage.py runserver`, o chat **n√£o funcionar√°** (WebSocket falhar√°).

---

### 6Ô∏è‚É£ Execute o app Flutter

```bash
cd mobile
flutter pub get
flutter run -d emulator-5554 --dart-define=BACKEND_HOST=http://10.0.2.2:8000
```

Troque o dispositivo ou o IP conforme necess√°rio.

---

## üí¨ WebSocket (Chat)

* O app converte automaticamente `http://` ‚Üí `ws://`
* Endpoint usado:

  ```
  /ws/chat/?token=JWT_TOKEN
  ```
* O backend **precisa estar com Daphne ativo**

Se ocorrer erro `"Connection reset by peer"`:

* ‚úÖ Verifique se o Daphne est√° rodando
* ‚úÖ Confirme o IP correto em `--dart-define`
* ‚úÖ Celular e PC est√£o na **mesma rede Wi-Fi**
* ‚úÖ Firewall do Windows n√£o bloqueia a porta 8000

---

## üß† Dicas √∫teis

* Teste o backend direto no navegador do celular:

  ```
  http://192.168.15.101:8000/api/
  ```
* **Emulador Android:** use `http://10.0.2.2:8000`
* **Celular f√≠sico:** use o IP LAN (`192.168.15.101`)
* No Django `settings.py`, mantenha:

  ```python
  ALLOWED_HOSTS = ['*']
  CORS_ALLOW_ALL_ORIGINS = True
  ```

---

## üêõ Erros comuns

| Erro                              | Causa                            | Solu√ß√£o                                                       |
| --------------------------------- | -------------------------------- | ------------------------------------------------------------- |
| ‚ùå *‚ÄúWebSocket connection failed‚Äù* | Servidor rodando com `runserver` | Rode com `daphne -b 0.0.0.0 -p 8000 backend.asgi:application` |
| ‚ùå *‚ÄúConnection refused‚Äù*          | IP incorreto no Flutter          | Corrija `--dart-define=BACKEND_HOST=http://SEU_IP:8000`       |
| ‚ùå *‚ÄúUser not authenticated‚Äù*      | Token JWT inv√°lido               | Refazer login e obter novo token                              |
| ‚ùå *‚ÄúDisallowedHost‚Äù*              | IP n√£o est√° em `ALLOWED_HOSTS`   | Adicione `'*'` no settings durante desenvolvimento            |

---

## üöÄ Execu√ß√£o R√°pida (TL;DR)

```bash
# Backend
cd backend
.venv\Scripts\Activate.ps1
daphne -b 0.0.0.0 -p 8000 backend.asgi:application

# Mobile
cd mobile
flutter pub get
flutter run --dart-define=BACKEND_HOST=http://192.168.15.101:8000
```

---
